# pages/Settings.py
import streamlit as st
from state.state import AppState, SettingsState

# 1) ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
if "app_state" not in st.session_state:
    st.session_state.app_state = AppState()
if "settings_state" not in st.session_state:
    st.session_state.settings_state = SettingsState()

state    = st.session_state.app_state
settings = st.session_state.settings_state

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="âš™ï¸ Settings", layout="centered")
st.header("âš™ï¸ Settings")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 2) ì¶œë ¥ MIME íƒ€ì… ì„¤ì •
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.subheader("ì¶œë ¥ MIME Types")
all_mime = [
    "text/plain",
    "application/json",
    "image/png",
    "image/jpeg",
    "application/pdf",
    "text/markdown",
]
selected = st.multiselect(
    "í—ˆìš©í•  MIME íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”",
    options=all_mime,
    default=settings.output_mime_types,
)
# ë³€ê²½ ë°˜ì˜
settings.output_mime_types = selected
st.caption(f"í˜„ì¬: {settings.output_mime_types}")

st.markdown("---")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3) í´ë§ ê°„ê²© ì„¤ì •
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.subheader("í´ë§ ê°„ê²© (ì´ˆ)")
interval = st.number_input(
    "ë°±ê·¸ë¼ìš´ë“œ í´ë§ ì£¼ê¸°ë¥¼ ì´ˆ ë‹¨ìœ„ë¡œ ì…ë ¥í•˜ì„¸ìš”",
    min_value=1,
    value=state.polling_interval,
)
state.polling_interval = interval
st.caption(f"í˜„ì¬ í´ë§ ê°„ê²©: {state.polling_interval}ì´ˆ")

st.markdown("---")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 4) API í‚¤ ê´€ë¦¬
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.subheader("API Key ì„¤ì •")
api_input = st.text_input(
    "API Key",
    value=state.api_key,
    type="password",
    help="Google API Key ë˜ëŠ” Vertex AI Keyë¥¼ ì…ë ¥í•˜ì„¸ìš”",
)
state.api_key = api_input

use_vertex = st.checkbox(
    "Vertex AI ì‚¬ìš©",
    value=state.uses_vertex_ai,
    help="ì²´í¬ ì‹œ Vertex AIë¥¼ ì‚¬ìš©í•˜ê³ , í•´ì œ ì‹œ API Key ê¸°ë°˜ìœ¼ë¡œ í˜¸ì¶œí•©ë‹ˆë‹¤",
)
state.uses_vertex_ai = use_vertex

st.markdown("---")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5) í…Œë§ˆ ëª¨ë“œ (AppStateì— ì¶”ê°€ë¡œ ê´€ë¦¬í•˜ê¸° ì›í•  ê²½ìš°)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
st.subheader("í…Œë§ˆ ëª¨ë“œ")
theme = st.selectbox(
    "ì‹œìŠ¤í…œ/ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”",
    options=["system", "light", "dark"],
    index=["system", "light", "dark"].index(state.theme_mode),
)
state.theme_mode = theme
st.caption(f"í˜„ì¬ í…Œë§ˆ ëª¨ë“œ: {state.theme_mode}")

st.markdown("---")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 6) ì €ì¥ ì™„ë£Œ ì•Œë¦¼
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if st.button("ğŸ’¾ ì„¤ì • ì €ì¥"):
    st.success("ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!")
